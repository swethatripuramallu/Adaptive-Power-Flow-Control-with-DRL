% Manually inputting the bus data from ieee 14 bus
% Header Information
header_info = [0, 100.00, 33, 0, 0, 60.00];

% Bus Data
% Columns: BusNum, Voltage, Type, Area, Zone, Owner, VoltagePU, Angle
bus_data = [
    1, 138.0000, 3, 1, 1, 1, 1.06000, 0.0000;
    2, 138.0000, 2, 1, 1, 1, 1.04500, -4.9826;
    3, 138.0000, 2, 1, 1, 1, 1.01000, -12.7250;
    4, 138.0000, 1, 1, 1, 1, 1.01767, -10.3128;
    5, 138.0000, 1, 1, 1, 1, 1.01951, -8.7738;
    6, 138.0000, 2, 1, 1, 1, 1.07000, -14.2209;
    7, 138.0000, 1, 1, 1, 1, 1.06152, -13.3596;
    8, 138.0000, 2, 1, 1, 1, 1.09000, -13.3596;
    9, 138.0000, 1, 1, 1, 1, 1.05593, -14.9385;
   10, 138.0000, 1, 1, 1, 1, 1.05099, -15.0972;
   11, 138.0000, 1, 1, 1, 1, 1.05691, -14.7906;
   12, 138.0000, 1, 1, 1, 1, 1.05519, -15.0755;
   13, 138.0000, 1, 1, 1, 1, 1.05038, -15.1562;
   14, 138.0000, 1, 1, 1, 1, 1.03553, -16.0336
];

% Load Data
% Columns: BusNum, LoadMW, LoadMVAR, Zeroes and Flags
load_data = [
    2, 21.700, 12.700, 0, 0, 0, 0, 0, 1, 1;
    3, 94.200, 19.000, 0, 0, 0, 0, 0, 1, 1;
    4, 47.800, -3.900, 0, 0, 0, 0, 0, 1, 1;
    5, 7.600, 1.600, 0, 0, 0, 0, 0, 1, 1;
    6, 11.200, 7.500, 0, 0, 0, 0, 0, 1, 1;
    9, 29.500, 16.600, 0, 0, 0, 0, 0, 1, 1;
   10, 9.000, 5.800, 0, 0, 0, 0, 0, 1, 1;
   11, 3.500, 1.800, 0, 0, 0, 0, 0, 1, 1;
   12, 6.100, 1.600, 0, 0, 0, 0, 0, 1, 1;
   13, 13.500, 5.800, 0, 0, 0, 0, 0, 1, 1;
   14, 14.900, 5.000, 0, 0, 0, 0, 0, 1, 1
];

% Fixed Shunt Data
% Columns: BusNum, ID, Status, RealPower, ReactivePower
fixed_shunt_data = [
    9, 1, 1, 0.000, 19.000
];

% Generator Data
% Columns: 
% 1. BusNum: Bus number
% 2. ID: Generator identifier
% 3. PG: Active power output (MW)
% 4. QG: Reactive power output (MVAR)
% 5. Qmax: Maximum reactive power output (MVAR)
% 6. Qmin: Minimum reactive power output (MVAR)
% 7. VoltageSetpoint: Voltage setpoint (p.u.)
% 8. MBase: Base MVA of the machine
% 9. Status: Machine status (1 = in-service, 0 = out-of-service)
% 10. Pmax: Maximum active power output (MW)
% 11. Pmin: Minimum active power output (MW)
% 12-26: Various control parameters (e.g., ramp rate limits)
generator_data = [
    1, 1, 232.392, -16.549, 0, 0, 1.06000, 100, 1, 615.000, 0, 1, 0, 0, 1, 100.0, 10000, -10000, 1, 1.0000, 0, 1.0000, 0, 1.0000, 0, 1.0000;
    2, 1, 40.000, 43.556, 50, -40, 1.04500, 60, 1, 60.000, 0, 1, 0, 0, 1, 100.0, 10000, -10000, 1, 1.0000, 0, 1.0000, 0, 1.0000, 0, 1.0000;
    3, 1, 0.000, 25.075, 40, 0, 1.01000, 60, 1, 60.000, 0, 1, 0, 0, 1, 100.0, 10000, -10000, 1, 1.0000, 0, 1.0000, 0, 1.0000, 0, 1.0000;
    6, 1, 0.000, 12.730, 24, -6, 1.07000, 25, 1, 25.000, 0, 1, 0, 0, 1, 100.0, 10000, -10000, 1, 1.0000, 0, 1.0000, 0, 1.0000, 0, 1.0000;
    8, 1, 0.000, 17.623, 24, -6, 1.09000, 25, 1, 25.000, 0, 1, 0, 0, 1, 100.0, 10000, -10000, 1, 1.0000, 0, 1.0000, 0, 1.0000, 0, 1.0000
];

% Branch Data
% 1. FromBus: Starting bus number
% 2. ToBus: Ending bus number
% 3. ID: Branch identifier
% 4. Resistance: Line resistance (p.u.)
% 5. Reactance: Line reactance (p.u.)
% 6. Susceptance: Line susceptance (p.u.)
% 7. RatingA: Long-term rating (MVA)
% 8. RatingB: Short-term rating (MVA)
% 9. RatingC: Emergency rating (MVA)
% 10. TapRatio: Transformer off-nominal turns ratio (if applicable)
% 11. PhaseShift: Transformer phase shift angle (degrees, if applicable)
% 12. G (Conductance): Line conductance at the 'from' bus (p.u.)
% 13. B (Susceptance): Line susceptance at the 'from' bus (p.u.)
% 14. Status: Line status (1 = in-service, 0 = out-of-service)
% 15. MeteredEnd: Metered end of the line (1 = 'from' bus, 0 = 'to' bus)
% 16-26: Various control parameters (e.g., line limits, tap changes)
branch_data = [
    1, 2, 1, 0.01938, 0.05917, 0.0528, 0, 0, 0, 0, 0, 0, 0, 1, 1, 0, 1, 1.0000, 0, 1.0000, 0, 1.0000, 0, 1.0000;
    1, 5, 1, 0.05403, 0.22304, 0.0492, 0, 0, 0, 0, 0, 0, 0, 1, 1, 0, 1, 1.0000, 0, 1.0000, 0, 1.0000, 0, 1.0000;
    2, 3, 1, 0.04699, 0.19797, 0.0438, 0, 0, 0, 0, 0, 0, 0, 1, 1, 0, 1, 1.0000, 0, 1.0000, 0, 1.0000, 0, 1.0000;
    2, 4, 1, 0.05811, 0.17632, 0.034, 0, 0, 0, 0, 0, 0, 0, 1, 1, 0, 1, 1.0000, 0, 1.0000, 0, 1.0000, 0, 1.0000;
    2, 5, 1, 0.05695, 0.17388, 0.0346, 0, 0, 0, 0, 0, 0, 0, 1, 1, 0, 1, 1.0000, 0, 1.0000, 0, 1.0000, 0, 1.0000;
    3, 4, 1, 0.06701, 0.17103, 0.0128, 0, 0, 0, 0, 0, 0, 0, 1, 1, 0, 1, 1.0000, 0, 1.0000, 0, 1.0000, 0, 1.0000;
    4, 5, 1, 0.01335, 0.04211, 0, 0, 0, 0, 0, 0, 0, 0, 1, 1, 0, 1, 1.0000, 0, 1.0000, 0, 1.0000, 0, 1.0000;
    6, 11, 1, 0.09498, 0.1989, 0, 0, 0, 0, 0, 0, 0, 0, 1, 1, 0, 1, 1.0000, 0, 1.0000, 0, 1.0000, 0, 1.0000;
    6, 12, 1, 0.12291, 0.25581, 0, 0, 0, 0, 0, 0, 0, 0, 1, 1, 0, 1, 1.0000, 0, 1.0000, 0, 1.0000, 0, 1.0000;
    6, 13, 1, 0.06615, 0.13027, 0, 0, 0, 0, 0, 0, 0, 0, 1, 1, 0, 1, 1.0000, 0, 1.0000, 0, 1.0000, 0, 1.0000;
    7, 8, 1, 0, 0.17615, 0, 0, 0, 0, 0, 0, 0, 0, 1, 1, 0, 1, 1.0000, 0, 1.0000, 0, 1.0000, 0, 1.0000;
    7, 9, 1, 0, 0.11001, 0, 0, 0, 0, 0, 0, 0, 0, 1, 1, 0, 1, 1.0000, 0, 1.0000, 0, 1.0000, 0, 1.0000;
    9, 10, 1, 0.03181, 0.0845, 0, 0, 0, 0, 0, 0, 0, 0, 1, 1, 0, 1, 1.0000, 0, 1.0000, 0, 1.0000, 0, 1.0000;
    9, 14, 1, 0.12711, 0.27038, 0, 0, 0, 0, 0, 0, 0, 0, 1, 1, 0, 1, 1.0000, 0, 1.0000, 0, 1.0000, 0, 1.0000;
   10, 11, 1, 0.08205, 0.19207, 0, 0, 0, 0, 0, 0, 0, 0, 1, 1, 0, 1, 1.0000, 0, 1.0000, 0, 1.0000, 0, 1.0000;
   12, 13, 1, 0.22092, 0.19988, 0, 0, 0, 0, 0, 0, 0, 0, 1, 1, 0, 1, 1.0000, 0, 1.0000, 0, 1.0000, 0, 1.0000;
   13, 14, 1, 0.17093, 0.34802, 0, 0, 0, 0, 0, 0, 0, 0, 1, 1, 0, 1, 1.0000, 0, 1.0000, 0, 1.0000, 0, 1.0000
];

% Transformer Data
transformer_data = [
    4, 7, 0, 1, 1, 1, 0, 0, 2, 1, 1, 1.0000, 0, 1.0000, 0, 1.0000, 0, 1.0000;
    4, 9, 0, 1, 1, 1, 0, 0, 2, 1, 1, 1.0000, 0, 1.0000, 0, 1.0000, 0, 1.0000;
    5, 6, 0, 1, 1, 1, 0, 0, 2, 1, 1, 1.0000, 0, 1.0000, 0, 1.0000, 0, 1.0000
];

% Area Data
area_data = [
    1, 2, 0.000, 999.990
];

% Zone Data
zone_data = [
    1
];

% Owner Data
owner_data = [
    1
];

% Save bus_data and line_data (branch_data) to a .mat file
save('powerflow_data.mat', 'bus_data', 'branch_data');

